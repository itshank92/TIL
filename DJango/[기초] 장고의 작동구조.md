# 장고의 작동 구조



## 장고의 기초

> Static vs Dynamic

* Static web site: 미리 공급자가 준비한 컨텐츠만 보여주는 웹사이트
* Dynamic web site: **사용자의 요청**에 따라 서버측에서 데이터를 가공, 처리해서 보여주는 웹사이트
  ▶장고는 다이나믹 웹사이트를 구축하는 도구이다.



> 장고의 구성 요소(3가지)

1. **Model**  ▷ 데이터 베이스 관리

2. **Template**  ▷  (사용자에게 보여주는) 레이아웃(화면)
   * 템플릿은 장고의 태그를 추가로 사용할 수 있는 `HTML` 파일이라 생각하면 된다

3. **View**  ▷  중심 컨트롤러(심장): Model과 Template을 관리하는 역할



> 대부분 웹프레임워크의 구성요소(디자인패턴)

(*디자인패턴: 사용자의 요청에 따라 어떻게 서비스가 구성되어 최종제공되는지에 대한 과정)

1. **Model** : 장고에서도 Model에 해당
2. **View** : 장고에서는 Template에 해당
3. **Controller**: 장고에서는 View에 해당



▶ 장고 개발팀이 자신들이 붙인 이름이 해당 기능을 더 직관적으로 설명한다고 생각해서 일반적인 방식과 다르게 명명한 것이다.



## 장고의 작동구조

![image-20210308091851889]((기초)장고의 작동구조.assets/image-20210308091851889.png)



> 장고의 작동 구조 설명

* **HTTP Request**
  * 사용자는 언제난 `URL`형태로 요청을 보낸다. 
  * 이 `URL`에는 사용자의 정보(`검색어`, `ID&PW`, `요청사항`, `환불요청` 등등)가 담겨있다.     



* **URLS**
  * 장고에서는 사용자의 요청(`URL`)을 받으면 가장 먼저 `URL` 매칭 파일을 확인한다.
  * `URL` 매칭 파일은 각 `URL`에 대해 `View`의 어떤 함수로 연결해줘야 하는지 나와있는 데이터다.
    * 네트워크로 따지면 일종의 라우팅테이블과 비슷하다.
  * `URL` 매칭파일(정확한 파일명은 `urls.py`)을 통해 사용자의 요청을 해당하는`View`의 함수로 보낸다.      



* **View**
  * `View`는 사용자에게 보여줄 화면(`Template`)과 해당 화면에 들어갈 데이터(`Model`)을 연결해주는 역할을 하는 함수들의 집합이다.
  * 사용자의 요청(`URL`)에 따라 적절한 `Model`(데이터 베이스 테이블)에 접근해서 사용자가 요청한 작업을 수행하고 필요한 데이터가 있다면 가져온다.
  * 데이터를 가져와서 최종적으로는 사용자에게 보여줄 페이지인 `Template`에 `dictionary`형태(변수명은 `context`)로 넘겨준다.     



* **Model**
  * 기본적으로 **모델**은 파이썬 코드의 **클래스로 표현한 데이터베이스 테이블**이다.
    * 모델에는 `fields` 라는 속성값에 column 요소가 리스트 형태로 들어가 있다.
  * 장고에서는 **모델**이라는 것을 사용해서 **데이터 베이스 테이블**을 만든다.
    * 즉, 파이썬(언어)을 통해 데이터 베이스 테이블을 만들고 수정하는 작업을 가능하게 해주는 것이 모델이다.
  * 모델은 장고에서 앱(`app`)의 하위 요소로 존재한다. 
    * `app` 디렉토리 밑의 `models.py`에 만들어진다.
  * **View**에서는 사용자의 요청을 처리하기 위한 **Model**에 접근해서 데이터를 관리 및 수정한다.    



* **Template**

  * 사용자의 요청에 따른 데이터 처리가 끝났다면, **View**는 사용자에게 보여줄 화면인 **Template**을 반환(`return`)한다.

    * 반환은 `render`라는 함수에 `request`(사용자의 요청)과 적절한 `template파일`을 인자로 넣어 반환한다. 
    * 이때, 사용자에게 보여줄 Template에 DB데이터가 필요다면 추가 인자로 넣어준다.
    * ★ **즉,** **View에서는 Model(DB테이블)과 Template(HTML)을 연결해주는 역할을 한다.** 

  * 주의할 점은 **Template**은 언제나 **데이터를 보여주는 화면**이지 데이터를 처리하는 기능을 수행하면 안된다는 것이다.

    * 이는 장고에서의 웹 개발 원칙으로, 각 요소는 자신이 맡은 기능만을 수행해야 한다는 것이다.

      
    
    

> 장고의 설계 철학

* **데이터 표현과 처리는 분리해야 한다.** 
  * 데이터 표현은 `template`이 하고 데이터 처리는 `view`가 수행해야 한다. 
  * `template`는 오직 데이터를 표현만 해야 한다. 
  * 이러한 기본 기능을 넘어서도록 코딩하면 안된다.
* `template`은 **중복을 배제하기 위해 만든 것**이다.
  * `templat`의 **상속 기능**을 통해 중복코드를 제거할 수 있다.
  * 여러 자식 `template`을 가진 부모 `template`의 경우 프로젝트 디렉토리 레벨의 `template` 폴더에 저장하여 사용한다.

