# 모델, 뷰, 템플릿 설명

#### 장고를 구성하는 3가지 요소



## 모델





## 뷰

* 뷰는 사용자가 요청한 URL에 걸맞는 화면을 보여주기 위해 **Model의 데이터**와 **Template의 화면**을 **연결시켜주는 역할**을 수행한다.

* 뷰 파일(`views.py`)은 app에 존재한다. (프로젝트에 있는게 아니다)

* 뷰 파일에 작성하는 함수의 첫번째 인자는 반드시 `request`다.
  * 뷰는 결국 사용자의 요청에 따라 보여주고자 하는 것을 작성하는 것이기에 기본 전제 입력값은 사용자의 요청이다.



## 템플릿

​      

> View 함수의 끝단에서 템플릿 파일이 반환(`return`)된다.

* **View**에서 **Model**을 통한 데이터 처리가 끝나면 적절한 **Template**을 반환한다.
* 이 때 **render**라는 함수의 인자로 **Template**파일이 들어가서 반환된다. 
* **템플릿을 불러오는 함수**인 `render`함수의 첫번째 인자는 `request`이다.
  * `request`(사용자의 요청)이 있어야 해당 Template을 누구에게 보여줄지 알 수 있다.
* `render`의 인자는 다음과 같다(순서 주의)
  * `render(request, 템플릿으로 불러올 html 파일경로, 템플릿에 전달할 데이터)`
  * 템플릿에 전달할 데이터는 `key:value` 형태로 전달한다.(아니면 `딕셔너리`를 전달하면 된다)
  * 전달받은 데이터는 템플릿 내에서 태그를 사용하여 접근 및 사용이 가능하다.      

​       



> 템플릿은 어디에 만들어야 하는가

* 기본적으로 템플릿은 `Application` 디렉토리 안에 작성한다.
  * `Application` 디렉토리에 `templates` 폴더를 만들고 해당 폴더 안에 작성해야 한다.
* 장고에서는 `Application` 디렉토리 안에 있는 `templates`폴더 안의 템플릿 파일들을 모두 하나의 폴더에 존재하는 것처럼 인식한다.
  * 즉 `Application_01` 디렉토리의 `templates`폴더 안의 `index.html`도, `Application_02` 디렉토리의 `templates`폴더 안의 `index.html`도, **장고에서는 하나의 공간에 존재하는 것으로 본다**.
    * 따라서 **같은 이름을 가진 템플릿 파일의 경우 겹치는 문제**가 생긴다.
    * 이를 방지하기 위해, 각 `Application` 디렉토리의 `templates` 폴더안에 해당 `Application`이름의 폴더를 만들고, 해당 폴더 안에 템플릿 파일을 만드는게 좋다.
    * (구조) `Project` > `Application` > `templates` > `application` > `template.html`
* 하지만 `Application`들이 공통으로 사용하는 템플릿 파일같은 경우 프로젝트 디렉토리에 만드는 것이 좋다.
  * 프로젝트 디렉토리에 `templates` 폴더를 만들고 공통으로 사용하는 템플릿 파일을 저장한다.



| **장고는 App 하위에 있는 templates 디렉터리를 자동으로 템플릿 디렉터리로 인식한다** |
| ------------------------------------------------------------ |
| 장고는 프로젝트 디렉터리 외에도 특정 App 디렉터리 하위에 있는 `templates`라는 이름의 디렉터리를 자동으로 템플릿 디렉터리로 인식한다. <br />예를 들어 `pybo`라는 앱이 있다고 할 때, `pybo` 디렉터리 밑의 `templates` 디렉터리는 별다른 설정을 하지 않아도 템플릿 디렉터리로 인식된다.<br /><br />`C:\projects\mysite\pybo\templates`<br /><br />하지만 이 방법으로 템플릿을 관리하는 것은 권장되지 않는다. 왜냐하면 하나의 사이트에서 **여러 앱을 사용할 때 여러 앱의 화면을 구성하는 템플릿은 한 디렉터리에 모아 관리하는 편이 여러모로 좋기 때문**이다. 예를 들어 여러 앱이 공통으로 사용하는 공통 템플릿을 어디에 저장해야 할지 생각해 보면 왜 이런 방법을 선호하는지 쉽게 이해될 것이다.<br /><br />● 공통 템플릿 디렉터리 ▶ `C:/projects/mysite/templatespybo` <br />● 앱 템플릿 디렉터리▶`C:/projects/mysite/templates/pybo` |

​        

​     

> DTL (Django Template Language)

* 장고에서 템플릿 내부에서 사용하는 템플릿 언어다.

* 파이썬처럼 일부 파이썬 문법을 사용할 수 있지만 DTL을 파이썬으로 실행시킬 수 있는 것은 아니다.

* 템플릿은 장고의 태그를 추가로 사용할 수 있는 HTML 파일이라 생각하면 된다.

  * html 문법내에서 장고의 태그를 사용하기 위한 문법이 바로 DTL이다.     

​     



> (장고의) 탬플릿 태그(Tag)

* 템플릿 태그는 {% 와 %}로 둘러싸인 문장을 말한다. 
* 다음 표에 정리한 템플릿 태그의 의미를 살펴보면 파이썬 문법과 크게 다르지 않음을 알 수 있다. 
* 템플릿 태그는 따로 문법을 설명하지 않고 그때그때 필요할 때마다 설명하겠다.

|               템플릿 태그               |                            의미                            |
| :-------------------------------------: | :--------------------------------------------------------: |
|        `{% if question_list %}`         |                   question_list가 있다면                   |
|  `{% for question in question_list %}`  |    question_list를 반복하며 순차적으로 question에 대입     |
|           `{{ question.id }}`           |       for 문에 의해 대입된 question 객체의 `id` 출력       |
|        `{{ question.subject }}`         |    `for` 문에 의해 대입된 question 객체의 subject 출력     |
| (`for`태그 아래에 사용됨) `{% empty %}` | `for`태그가 순회하는 대상에 어떠한 요소도 없는 경우 실행됨 |

​     



### 템플릿 태그! 3가지 유형만 정리하면 끝!

장고의 템플릿 태그에는 **분기** ,  **반복** , **객체 출력**이라는 3가지 대표적인 유형만 알면 된다. 

1. **분기 템플릿 태그**는 파이썬의 `if` 문과 같은 기능을 수행하는 태그다. 
   차이점은 `if` 문이 끝나는 부분에 `{% endif %}`를 사용한다는 것이다. 

```python
{% if 조건문1 %}
    <p>조건문1이 참인 경우 실행됨</p>
    
{% elif 조건문2 %}
    <p>조건문1이 참인 경우 실행됨</p>
    
{% else %}
    <p>조건문1, 2에 모두 참이 아닌 경우 실행됨</p>
    
{% endif %}  
```

​       

2. **반복 템플릿 태그**는 파이썬의 `for` 문과 같은 기능을 수행하는 태그다. 
   차이점은 분기태그와 마찬가지로 마지막은 `{% endfor %}`로 닫아야 한다는 것이다.

```python
{% for item in list %}
    <p>순서: {{ forloop.counter }} </p>
    <p>{{ item }}</p>
{% endfor %}
```



※ 또한 반복 템플릿 안에서는 `forloop` 객체를 사용할 수도 있다. `forloop` 객체는 반복 중 유용한 값을 제공한다.

| forloop 객체 속성  |                 설명                  |
| :----------------: | :-----------------------------------: |
| `forloop.counter`  | `for` 문의 순서로 숫자  `1`부터 표시  |
| `forloop.counter0` |  `for` 문의 순서로 숫자 `0`부터 표시  |
|  `forloop.first`   | `for` 문의 첫 번째 순서인 경우 `True` |
|   `forloop.last`   | `for` 문의 마지막 순서인 경우 `True`  |

​        

3. **객체 출력 템플릿 태그**는 다음과 같다. 객체에 속성(attribute)이 있는 경우 파이썬과 동일한 방법으로 점(`.`) 연산자를 사용한다.

```
{{ question }}
{{ question.id }}
{{ question.subject }}
```

​       



> 부모 템플릿과 자식 템플릿

* **부모 템플릿**에서는 `{% block %}`와 `{% endblock%}` 사이에 자식 템플릿이 쓸 수 있는 공간을 만든다.
  * `{% block %}`에는 이름을 지정할 수 있다.
    * (예시) `{% block name %}`
  * 이렇게 이름을 지정하면 자식 템플릿에서 원하는 `block`을 선택에서 입력할 수 있다. 

* **자식 템플릿**에서는 `{% extends '부모 템플릿 경로' %}`로 상속받음을 선언하고 `{% block name %}`과 `{% endblock %}`사이에 넣을 내용을 작성한다.
  * **★주의★** `{% extends %}`를 사용할 때는 반드시 **템플릿 최상단에 작성**되어야 한다.     

​    

 