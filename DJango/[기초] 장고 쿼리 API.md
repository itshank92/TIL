# Database API



* Database-abstract API or Database-access API

* 데이터 베이스와 대화하기 위한 것 (= DB를 조작하기 위한 명령어)

* 모델 생성시 데이터 베이스 테이블을 읽고 수정할 수 있는 DB-Abstrat-API가 (자동으로) 생성된다





> 문법

* 형태: `모델(클래스)이름 . objects.  API의 쿼리문() `

* 예시: `Article.objects.all()`

* 결과: 해당 쿼리문에 맞는 데이터를 반환한다.     
* 



> objects

* 장고 모델의 **데이터 베이스 쿼리문들이 저장되는 공간**(인터페이스)
* manager라고도 불린다. (`모델`과 `데이터베이스 명령어`(API쿼리문)를 연결하는 역할)    





> 쿼리셋

* 쿼리문을 통해 데이터베이스로부터 전달받은 **데이터 목록(객체 목록)**
  * 쿼리셋안의 데이터(객체)는 0개, 1개 혹은 여러개일 수 있음

* 데이터베이스로부터 조회, 필터, 정렬 등을 수행할 수 있다.

* 쿼리셋은 기본적으로 리스트로 여러 ROW들을 담을 수 있다.
  * **쿼리셋은 파이썬의 리스트와 비슷**하다 ▶ 파이썬의 리스트 조작처럼 조작할 수 있다

* API 명령문에는 여러 줄(**쿼리셋**)을 가져오는 API쿼리문이 있다. 

* 반대로 쿼리셋이 아닌 **하나의 ROW**만 가져오는 API 쿼리문도 있다. (예시 `get`)





> 장고에서 사용하는 파이썬 shell

* 해당 shell은 기능이 부족해서 다른 모듈을 설치해서 사용하자

* `django-extensions`를 `pip`로 `install`하고 `settings.py`에 해당 어플을 등록하여 사용한다.

  (등록시 이름은 `django_extensions`)

* 명령어: `python manage.py shell_plus`

* 기능: 우리가 장고에서 사용할 만한 모듈을 모두 `import` 해줘서 바로 쓸 수 있게 해준다.





# CRUD



**`API 쿼리문`으로 `CRUD`를 수행해보자**



> CRUD 기본

* 대부분의 컴퓨터 소프트웨어가 가지는 기본적인 데이터 처리 기능인 `Create`(생성), `Read`(읽기), `Update`(갱신), `Delete`(삭제)를 묶어서 일컫는 말이다.





> 명령어

`모델이름(클래스이름).objects.API쿼리문()` 

▶ API쿼리문에 해당하는 데이터를 모델과 연결된 테이블에서 찾아서 작업함(생성, 읽기, 갱신, 삭제 등)

▶ (예시) `Article.objects.all()`



API쿼리문으로 `쿼리셋`을 받는 경우, Python에서 리스트를 조작하는 것처럼 조작할 수 있다.







> Create: 데이터를 생성하는 3가지 단계



1. 모델 클래스를 사용해서 instance를 만든다. 

   * 객체 생성시 해당 객체는 아직 DB에 입력된 데이터가 아니기에 id값이 None이다.

     (파이썬 코드상에서만 존재하고 있지 아직은 데이터 베이스에 들어있는 데이터가 아니다.)

   * `article = Articles()`



2. 해당 모델의 필드값을 넣어준다. 
   * 객체.속성 = 값  형태로 넣어준다.
   * `article.title = 'first'`
   * `article.content = 'django'`



3. 이렇게 객체를 생성한 다음 데이터를 입력한다.
   * 데이터 입력이 끝났으면 해당 객체를 DB에 저장하는 명령어(`.save()`)를 실행한다.
   * `article.save()`



**★ 이렇게 복잡한 것을 objects에서는 create라는 메소드로 한번에 수행 가능하다. ★**

`Article.objects.create(title='title', content='content')`

\>\> 동작과 동시에 수행됨(생성 + 저장됨)





# field__lookup



데이터 조회시 **좀 더 자세하게 조회할 수 있는 인자들 모음집**

API 쿼리문 중 조회 관련 쿼이문인 `get`과 `filer`의 인자로 들어갈 수 있다.



사용 방법:  `field명__사용하려는lookup기능 = 값`





# update



데이터를 불러와서 속성 = 값으로 수정

수정 후에 `.save()` 수행해야됨



# delete

데이터를 불러와서 `.delete()`하면 된다.

※ 삭제후에 새로운 데이터를 넣으면 지워진 id가 아닌 가장 아래의 id로 기록된다.

(**삭제된 데이터의 id는 다시 활용되지 않는다.**)

